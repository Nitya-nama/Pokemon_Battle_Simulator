<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pokémon Battle Simulator</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Future Tech Font, sans-serif;
      background: linear-gradient(to bottom, #0f172a, #1e293b);
      color: #ffffff;
      min-height: 100vh;
      padding: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      font-family: 'Press Start 2P', cursive;
      font-size: 24px;
      margin-bottom: 30px;
      color: #38bdf8;
      text-align: center;
      text-shadow: 2px 2px #0f172a;
    }

    .container {
      width: 100%;
      max-width: 900px;
      background: #1e293b;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 0 25px rgba(0, 0, 0, 0.4);
    }

    .card-row {
      display: flex;
      gap: 20px;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .poke-card {
      flex: 1;
      background: #334155;
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      transition: transform 0.3s;
      position: relative;
    }

    .poke-card:hover {
      transform: scale(1.03);
    }

    input[type="text"] {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      margin-top: 10px;
    }

    .autocomplete-box {
      background-color: #1e293b;
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      z-index: 10;
      border-radius: 6px;
      border: 1px solid #334155;
      max-height: 120px;
      overflow-y: auto;
    }

    .autocomplete-item {
      padding: 8px 12px;
      cursor: pointer;
    }

    .autocomplete-item:hover {
      background-color: #334155;
    }

    .sprite {
      margin-top: 20px;
      height: 100px;
    }

    button {
      font-family: 'Press Start 2P', cursive;
      width: 100%;
      padding: 15px;
      margin-top: 30px;
      font-size: 16px;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      background-color: #10b981;
      color: #fff;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #059669;
      cursor: pointer;
    }

    #winnerBox {
      margin-top: 15px;
      font-size: 18px;
      font-weight: bold;
      color: #22c55e;
      text-align: center;
    }

    .log {
      margin-top: 30px;
      background: #0f172a;
      padding: 20px;
      border-radius: 10px;
      font-family: monospace;
      font-size: 15px;
      white-space: pre-wrap;
      border: 1px solid #334155;
    }

    @media (max-width: 768px) {
      .card-row {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <h1>Pokémon Battle Simulator</h1>
  <div class="container">
    <div class="card-row">
      <div class="poke-card">
        <h3>Pokémon 1</h3>
        <input type="text" id="pokemon1" placeholder="e.g. pikachu" />
        <div class="autocomplete-box" id="list1"></div>
        <div id="sprite1"></div>
      </div>
      <div class="poke-card">
        <h3>Pokémon 2</h3>
        <input type="text" id="pokemon2" placeholder="e.g. charizard" />
        <div class="autocomplete-box" id="list2"></div>
        <div id="sprite2"></div>
      </div>
    </div>

    <button onclick="simulateBattle()">⚔️ Simulate Battle</button>
    <div id="winnerBox"></div>
    <div class="log" id="battleLog">Enter Pokémon names and simulate a battle.</div>
  </div>

  <script>
    const pokemonNames = [
    "bulbasaur", "ivysaur", "venusaur", "charmander", "charmeleon", "charizard", "squirtle", "wartortle", "blastoise", "caterpie",
    "metapod", "butterfree", "weedle", "kakuna", "beedrill", "pidgey", "pidgeotto", "pidgeot", "rattata", "raticate",
    "spearow", "fearow", "ekans", "arbok", "pikachu", "raichu", "sandshrew", "sandslash", "nidoran-f", "nidorina",
    "nidoqueen", "nidoran-m", "nidorino", "nidoking", "clefairy", "clefable", "vulpix", "ninetales", "jigglypuff", "wigglytuff",
    "zubat", "golbat", "oddish", "gloom", "vileplume", "paras", "parasect", "venonat", "venomoth", "diglett",
    "dugtrio", "meowth", "persian", "psyduck", "golduck", "mankey", "primeape", "growlithe", "arcanine", "poliwag",
    "poliwhirl", "poliwrath", "abra", "kadabra", "alakazam", "machop", "machoke", "machamp", "bellsprout", "weepinbell",
    "victreebel", "tentacool", "tentacruel", "geodude", "graveler", "golem", "ponyta", "rapidash", "slowpoke", "slowbro",
    "magnemite", "magneton", "farfetch-d", "doduo", "dodrio", "seel", "dewgong", "grimer", "muk", "shellder",
    "cloyster", "gastly", "haunter", "gengar", "onix", "drowzee", "hypno", "krabby", "kingler", "voltorb",
    "electrode", "exeggcute", "exeggutor", "cubone", "marowak", "hitmonlee", "hitmonchan", "lickitung", "koffing", "weezing",
    "rhyhorn", "rhydon", "chansey", "tangela", "kangaskhan", "horsea", "seadra", "goldeen", "seaking", "staryu",
    "starmie", "mr-mime", "scyther", "jynx", "electabuzz", "magmar", "pinsir", "tauros", "magikarp", "gyarados",
    "lapras", "ditto", "eevee", "vaporeon", "jolteon", "flareon", "porygon", "omanyte", "omastar", "kabuto",
    "kabutops", "aerodactyl", "snorlax", "articuno", "zapdos", "moltres", "dratini", "dragonair", "dragonite", "mewtwo",
    "mew", "chikorita", "bayleef", "meganium", "cyndaquil", "quilava", "typhlosion", "totodile", "croconaw", "feraligatr",
    "sentret", "furret", "hoothoot", "noctowl", "ledyba", "ledian", "spinarak", "ariados", "crobat", "chinchou",
    "lanturn", "pichu", "cleffa", "igglybuff", "togepi", "togetic", "natu", "xatu", "mareep", "flaaffy",
    "ampharos", "bellossom", "marill", "azumarill", "sudowoodo", "politoed", "hoppip", "skiploom", "jumpluff", "aipom",
    "sunkern", "sunflora", "yanma", "wooper", "quagsire", "espeon", "umbreon", "murkrow", "slowking", "misdreavus",
    "unown", "wobbuffet", "girafarig", "pineco", "forretress", "dunsparce", "gligar", "steelix", "snubbull", "granbull",
    "qwilfish", "scizor", "shuckle", "heracross", "sneasel", "teddiursa", "ursaring", "slugma", "magcargo", "swinub",
    "piloswine", "corsola", "remoraid", "octillery", "delibird", "mantine", "skarmory", "houndour", "houndoom", "kingdra",
    "phanpy", "donphan", "porygon2", "stantler", "smeargle", "tyrogue", "hitmontop", "smoochum", "elekid", "magby",
    "miltank", "blissey", "raikou", "entei", "suicune", "larvitar", "pupitar", "tyranitar", "lugia", "ho-oh",
    "celebi", "treecko", "grovyle", "sceptile", "torchic", "combusken", "blaziken", "mudkip", "marshtomp", "swampert",
    "poochyena", "mightyena", "zigzagoon", "linoone", "wurmple", "silcoon", "beautifly", "cascoon", "dustox", "lotad",
    "lombre", "ludicolo", "seedot", "nuzleaf", "shiftry", "taillow", "swellow", "wingull", "pelipper", "ralts",
    "kirlia", "gardevoir", "surskit", "masquerain", "shroomish", "breloom", "slakoth", "vigoroth", "slaking", "nincada",
    "ninjask", "shedinja", "whismur", "loudred", "exploud", "makuhita", "hariyama", "azurill", "nosepass", "skitty",
    "delcatty", "sableye", "mawile", "aron", "lairon", "aggron", "meditite", "medicham", "electrike", "manectric",
    "plusle", "minun", "volbeat", "illumise", "roselia", "gulpin", "swalot", "carvanha", "sharpedo", "wailmer",
    "wailord", "numel", "camerupt", "torkoal", "spoink", "grumpig", "spinda", "trapinch", "vibrava", "flygon",
    "cacnea", "cacturne", "swablu", "altaria", "zangoose", "seviper", "lunatone", "solrock", "barboach", "whiscash",
    "corphish", "crawdaunt", "baltoy", "claydol", "lileep", "cradily", "anorith", "armaldo", "feebas", "milotic",
    "castform", "kecleon", "shuppet", "banette", "duskull", "dusclops", "tropius", "chimecho", "absol", "wynaut",
    "snorunt", "glalie", "spheal", "sealeo", "walrein", "clamperl", "huntail", "gorebyss", "relicanth", "luvdisc",
    "bagon", "shelgon", "salamence", "beldum", "metang", "metagross", "regirock", "regice", "registeel", "latias",
    "latios", "kyogre", "groudon", "rayquaza", "jirachi", "deoxys", "turtwig", "grotle", "torterra", "chimchar",
    "monferno", "infernape", "piplup", "prinplup", "empoleon", "starly", "staravia", "staraptor", "bidoof", "bibarel",
    "kricketot", "kricketune", "shinx", "luxio", "luxray", "budew", "roserade", "cranidos", "rampardos", "shieldon",
    "bastiodon", "burmy", "wormadam", "mothim", "combee", "vespiquen", "pachirisu", "buizel", "floatzel", "cherubi",
    "cherrim", "shellos", "gastrodon", "ambipom", "drifloon", "drifblim", "buneary", "lopunny", "mismagius", "honchkrow",
    "glameow", "purugly", "chingling", "stunky", "skuntank", "bronzor", "bronzong", "bonsly", "mime-jr", "happiny",
    "chatot", "spiritomb", "gible", "gabite", "garchomp", "munchlax", "riolu", "lucario", "hippopotas", "hippowdon",
    "skorupi", "drapion", "croagunk", "toxicroak", "carnivine", "finneon", "lumineon", "mantyke", "snover", "abomasnow",
    "weavile", "magnezone", "lickilicky", "rhyperior", "tangrowth", "electivire", "magmortar", "togekiss", "yanmega", "leafeon",
    "glaceon", "gliscor", "mamoswine", "porygon-z", "gallade", "probopass", "dusknoir", "froslass", "rotom", "uxie",
    "mesprit", "azelf", "dialga", "palkia", "heatran", "regigigas", "giratina", "cresselia", "phione", "manaphy",
    "darkrai", "shaymin", "arceus", "victini", "snivy", "servine", "serperior", "tepig", "pignite", "emboar",
    "oshawott", "dewott", "samurott", "patrat", "watchog", "lillipup", "herdier", "stoutland", "purrloin", "liepard",
    "pansage", "simisage", "pansear", "simisear", "panpour", "simipour", "munna", "musharna", "pidove", "tranquill",
    "unfezant", "blitzle", "zebstrika", "roggenrola", "boldore", "gigalith", "woobat", "swoobat", "drilbur", "excadrill",
    "audino", "timburr", "gurdurr", "conkeldurr", "tympole", "palpitoad", "seismitoad", "throh", "sawk", "sewaddle",
    "swadloon", "leavanny", "venipede", "whirlipede", "scolipede", "cottonee", "whimsicott", "petilil", "lilligant", "basculin",
    "sandile", "krokorok", "krookodile", "darumaka", "darmanitan", "maractus", "dwebble", "crustle", "scraggy", "scrafty",
    "sigilyph", "yamask", "cofagrigus", "tirtouga", "carracosta", "archen", "archeops", "trubbish", "garbodor", "zorua",
    "zoroark", "minccino", "cinccino", "gothita", "gothorita", "gothitelle", "solosis", "duosion", "reuniclus", "ducklett",
    "swanna", "vanillite", "vanillish", "vanilluxe", "deerling", "sawsbuck", "emolga", "karrablast", "escavalier", "foongus",
    "amoonguss", "frillish", "jellicent", "alomomola", "joltik", "galvantula", "ferroseed", "ferrothorn", "klink", "klang",
    "klinklang", "tynamo", "eelektrik", "eelektross", "elgyem", "beheeyem", "litwick", "lampent", "chandelure", "axew",
    "fraxure", "haxorus", "cubchoo", "beartic", "cryogonal", "shelmet", "accelgor", "stunfisk", "mienfoo", "mienshao",
    "druddigon", "golett", "golurk", "pawniard", "bisharp", "bouffalant", "rufflet", "braviary", "vullaby", "mandibuzz",
    "heatmor", "durant", "deino", "zweilous", "hydreigon", "larvesta", "volcarona", "cobalion", "terrakion", "virizion",
    "tornadus", "thundurus", "reshiram", "zekrom", "landorus", "kyurem", "keldeo", "meloetta", "genesect", "chespin",
    "quilladin", "chesnaught", "fennekin", "braixen", "delphox", "froakie", "frogadier", "greninja", "bunnelby", "diggersby",
    "fletchling", "fletchinder", "talonflame", "scatterbug", "spewpa", "vivillon", "litleo", "pyroar", "flabebe", "floette",
    "florges", "skiddo", "gogoat", "pancham", "pangoro", "furfrou", "espurr", "meowstic", "honedge", "doublade",
    "aegislash", "spritzee", "aromatisse", "swirlix", "slurpuff", "inkay", "malamar", "binacle", "barbaracle", "skrelp",
    "dragalge", "clauncher", "clawitzer", "helioptile", "heliolisk", "tyrunt", "tyrantrum", "amaura", "aurorus", "sylveon",
    "hawlucha", "dedenne", "carbink", "goomy", "sliggoo", "goodra", "klefki", "phantump", "trevenant", "pumpkaboo",
    "gourgeist", "bergmite", "avalugg", "noibat", "noivern", "xerneas", "yveltal", "zygarde", "diancie", "hoopa",
    "volcanion", "rowlet", "dartrix", "decidueye", "litten", "torracat", "incineroar", "popplio", "brionne", "primarina",
    "pikipek", "trumbeak", "toucannon", "yungoos", "gumshoos", "grubbin", "charjabug", "vikavolt", "crabrawler", "crabominable",
    "oricorio", "cutiefly", "ribombee", "rockruff", "lycanroc", "wishiwashi", "mareanie", "toxapex", "mudbray", "mudsdale",
    "dewpider", "araquanid", "fomantis", "lurantis", "morelull", "shiinotic", "salandit", "salazzle", "stufful", "bewear",
    "bounsweet", "steenee", "tsareena", "comfey", "oranguru", "passimian", "wimpod", "golisopod", "sandygast", "palossand",
    "pyukumuku", "type-null", "silvally", "minior", "komala", "turtonator", "togedemaru", "mimikyu", "bruxish", "drampa",
    "dhelmise", "jangmo-o", "hakamo-o", "kommo-o", "tapu-koko", "tapu-lele", "tapu-bulu", "tapu-fini", "cosmog", "cosmoem",
    "solgaleo", "lunala", "nihilego", "buzzwole", "pheromosa", "xurkitree", "celesteela", "kartana", "guzzlord", "necrozma",
    "magearna", "marshadow", "poipole", "naganadel", "stakataka", "blacephalon", "zeraora", "meltan", "melmetal", "grookey",
    "thwackey", "rillaboom", "scorbunny", "raboot", "cinderace", "sobble", "drizzile", "inteleon", "skwovet", "greedent",
    "rookidee", "corvisquire", "corviknight", "blipbug", "dottler", "orbeetle", "nickit", "thievul", "gossifleur", "eldegoss",
    "wooloo", "dubwool", "chewtle", "drednaw", "yamper", "boltund", "rolycoly", "carkol", "coalossal", "applin",
    "flapple", "appletun", "silicobra", "sandaconda", "cramorant", "arrokuda", "barraskewda", "toxel", "toxtricity", "sizzlipede",
    "centiskorch", "clobbopus", "grapploct", "sinistea", "polteageist", "hatenna", "hattrem", "hatterene", "impidimp", "morgrem",
    "grimmsnarl", "obstagoon", "perrserker", "cursola", "sirfetch-d", "mr-rime", "runerigus", "milcery", "alcremie", "falinks",
    "pincurchin", "snom", "frosmoth", "stonjourner", "eiscue", "indeedee", "morpeko", "cufant", "copperajah", "dracozolt",
    "arctozolt", "dracovish", "arctovish", "duraludon", "dreepy", "drakloak", "dragapult", "zacian", "zamazenta", "eternatus",
    "kubfu", "urshifu", "zarude", "regieleki", "regidrago", "glastrier", "spectrier", "calyrex", "wyrdeer", "kleavor",
    "ursaluna", "basculegion", "sneasler", "overqwil", "enamorus", "sprigatito", "floragato", "meowscarada", "fuecoco", "crocalor",
    "skeledirge", "quaxly", "quaxwell", "quaquaval", "lechonk", "oinkologne", "tarountula", "spidops", "nymble", "lokix",
    "pawmi", "pawmo", "pawmot", "tandemaus", "maushold", "fidough", "dachsbun", "smoliv", "dolliv", "arboliva",
    "squawkabilly", "nacli", "naclstack", "garganacl", "charcadet", "armarouge", "ceruledge", "tadbulb", "bellibolt", "wattrel",
    "kilowattrel", "maschiff", "mabosstiff", "shroodle", "grafaiai", "bramblin", "brambleghast", "toedscool", "toedscruel", "klawf",
    "capsakid", "scovillain", "rellor", "rabsca", "flittle", "espathra", "tinkatink", "tinkatuff", "tinkaton", "wiglett",
    "wugtrio", "bombirdier", "finizen", "palafin", "varoom", "revavroom", "cyclizar", "orthworm", "glimmet", "glimmora",
    "greavard", "houndstone", "flamigo", "cetoddle", "cetitan", "veluza", "dondozo", "tatsugiri", "annihilape", "clodsire",
    "farigiraf", "dudunsparce", "kingambit", "great-tusk", "scream-tail", "brute-bonnet", "flutter-mane", "slither-wing", "sandy-shocks", "iron-treads",
    "iron-bundle", "iron-hands", "iron-jugulis", "iron-moth", "iron-thorns", "frigibax", "arctibax", "baxcalibur", "gimmighoul", "gholdengo",
    "wo-chien", "chien-pao", "ting-lu", "chi-yu", "roaring-moon", "iron-valiant", "koraidon", "miraidon", "walking-wake", "iron-leaves",
    "dipplin", "poltchageist", "sinistcha", "okidogi", "munkidori", "fezandipiti", "ogerpon", "archaludon", "hydrapple", "gouging-fire",
    "raging-bolt", "iron-boulder", "iron-crown", "terapagos", "pecharunt"
  ];

    function setupAutocomplete(inputId, listId) {
    const input = document.getElementById(inputId);
    const listDiv = document.getElementById(listId);

    input.addEventListener('input', function () {
      listDiv.innerHTML = '';
      const val = this.value.toLowerCase();
      if (!val) return;

      const matches = pokemonNames.filter(name => name.startsWith(val)).slice(0, 6);
      matches.forEach(name => {
        const item = document.createElement('div');
        item.textContent = name;
        item.classList.add('autocomplete-item');
        item.onclick = () => {
          input.value = name;
          listDiv.innerHTML = '';
        };
        listDiv.appendChild(item);
      });
    });

    document.addEventListener('click', function (e) {
      if (!input.contains(e.target)) {
        listDiv.innerHTML = '';
      }
    });
  }

  setupAutocomplete('pokemon1', 'list1');
  setupAutocomplete('pokemon2', 'list2');

  // Highlight key phrases in the battle log for better readability
  function highlightLogLine(line) {
    const lower = line.toLowerCase();
    if (lower.includes('critical hit')) {
      return `<span style="color:#f87171; font-weight:bold;">${line}</span>`;
    }
    if (lower.includes('is now paralyzed') || lower.includes('is now burned') || lower.includes('is now poisoned')) {
      return `<span style="color:#34d399; font-weight:bold;">${line}</span>`;
    }
    if (lower.includes('fainted')) {
      return `<span style="color:#fbbf24; font-weight:bold;">${line}</span>`;
    }
    if (lower.includes('super effective')) {
      return `<span style="color:#fb923c;">${line}</span>`;
    }
    if (lower.includes('not very effective')) {
      return `<span style="color:#60a5fa;">${line}</span>`;
    }
    return line;
  }

  async function simulateBattle() {
    const p1 = document.getElementById('pokemon1').value.trim().toLowerCase();
    const p2 = document.getElementById('pokemon2').value.trim().toLowerCase();
    const logBox = document.getElementById('battleLog');
    const winnerBox = document.getElementById('winnerBox');
    const sprite1 = document.getElementById('sprite1');
    const sprite2 = document.getElementById('sprite2');

    winnerBox.textContent = "";
    logBox.textContent = "⏳ Simulating battle... Please wait.";
    sprite1.innerHTML = "";
    sprite2.innerHTML = "";

    if (!p1 || !p2) {
      alert("Please enter both Pokémon names.");
      return;
    }

    try {
      const [res1, res2] = await Promise.all([
        fetch(`https://pokeapi.co/api/v2/pokemon/${p1}`),
        fetch(`https://pokeapi.co/api/v2/pokemon/${p2}`)
      ]);

      const errors = [];
      if (!res1.ok) errors.push(`❌ Pokémon 1 ("${p1}") not found`);
      if (!res2.ok) errors.push(`❌ Pokémon 2 ("${p2}") not found`);

      if (errors.length > 0) {
        logBox.textContent = errors.join("\n") + "\n\nPlease correct the Pokémon name(s).";
        return;
      }

      const d1 = await res1.json();
      const d2 = await res2.json();

      sprite1.innerHTML = `
        <img src="${d1.sprites.front_default}" class="sprite" alt="${p1}" />
        <div><strong>Abilities:</strong> ${d1.abilities.map(ab => ab.ability.name).join(', ')}</div>`;
      sprite2.innerHTML = `
        <img src="${d2.sprites.front_default}" class="sprite" alt="${p2}" />
        <div><strong>Abilities:</strong> ${d2.abilities.map(ab => ab.ability.name).join(', ')}</div>`;

      const response = await fetch("http://127.0.0.1:5000/tool/simulate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ pokemon1: p1, pokemon2: p2 })
      });

      const result = await response.json();

      if (!response.ok || result.error) {
        logBox.textContent = `❌ Error: ${result.error || "Simulation failed."}`;
        return;
      }

      // Apply highlighting to each line of the battle log
      logBox.innerHTML = result.battle_log.map(highlightLogLine).join('\n');
      winnerBox.textContent = `🏆 Winner: ${result.winner.toUpperCase()}`;
    } catch (error) {
      logBox.textContent = "❌ Unexpected error. Make sure the Flask server is running.";
      winnerBox.textContent = "";
    }
  }
</script>

</body>
</html>
